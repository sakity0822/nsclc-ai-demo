import streamlit as st

# データ（NSCLC治療パス）
data = [
    {
        "ステージ": "ステージIV（初回）",
        "ドライバー変異": "EGFR陽性",
        "使用薬剤": "EGFR-TKI（ゲフィチニブなど）",
        "判断ポイント": "EGFR変異の有無",
        "次の選択肢": "T790M陽性ならオシメルチニブへ",
        "根拠": "EGFR変異陽性の患者には、EGFR-TKIが標準治療とされている（肺癌診療GL 2023）"
    },
    {
        "ステージ": "ステージIV（初回）",
        "ドライバー変異": "EGFR陰性",
        "使用薬剤": "免疫チェックポイント阻害薬＋化学療法",
        "判断ポイント": "PD-L1発現率・全身状態",
        "次の選択肢": "病勢進行でドセタキセルへ",
        "根拠": "EGFR陰性かつPD-L1発現率が高い場合、免疫チェックポイント阻害薬＋化学療法が推奨（GL）"
    },
    {
        "ステージ": "2次治療",
        "ドライバー変異": "EGFR-TKI耐性（T790M）",
        "使用薬剤": "オシメルチニブ",
        "判断ポイント": "T790M陽性確認",
        "次の選択肢": "病勢進行で化学療法へ",
        "根拠": "T790M変異がある場合、オシメルチニブが有効（AURA3試験）"
    },
    {
        "ステージ": "2次治療",
        "ドライバー変異": "免疫チェックポイント阻害薬後",
        "使用薬剤": "ドセタキセル±ラムシルマブ",
        "判断ポイント": "副作用・奏効状況",
        "次の選択肢": "再度TKI検討・支持療法",
        "根拠": "免疫治療後の進行例には、細胞障害性抗がん剤が使用される（GL）"
    },
    {
        "ステージ": "3次治療",
        "ドライバー変異": "分子標的薬後",
        "使用薬剤": "レジメン変更（例：TS-1）",
        "判断ポイント": "体力・副作用",
        "次の選択肢": "緩和ケアや臨床試験",
        "根拠": "分子標的薬使用歴がある場合、レジメン変更や緩和治療が考慮される"
    },
    {
        "ステージ": "3次治療",
        "ドライバー変異": "全身状態良好",
        "使用薬剤": "ベストサポーティブケア",
        "判断ポイント": "症状の緩和が中心",
        "次の選択肢": "緩和ケア中心に",
        "根拠": "体力的に治療が難しい場合、BSCが推奨される（緩和医療GL）"
    }
]

st.title("非小細胞肺がん（NSCLC）治療支援AIデモ")

# 入力欄
stage = st.selectbox("ステージを選んでください", sorted(set(d["ステージ"] for d in data)))
mutation = st.selectbox("ドライバー変異を選んでください", sorted(set(d["ドライバー変異"] for d in data)))

# 一致するデータを表示
matched = [d for d in data if d["ステージ"] == stage and d["ドライバー変異"] == mutation]

if matched:
    info = matched[0]
    st.markdown(f"### 💊 使用薬剤：{info['使用薬剤']}")
    st.markdown(f"### 📌 判断ポイント：{info['判断ポイント']}")
    st.markdown(f"### 🔁 次の選択肢：{info['次の選択肢']}")
    st.markdown("### 📖 根拠：")
    st.info(info["根拠"])
else:
    st.warning("該当する治療パスが見つかりませんでした。")

